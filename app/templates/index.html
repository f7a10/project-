<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SmartDataHub - AI-Powered Data Analysis</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Reset and base styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }
    body {
      background-color: #0f1123;
      color: #fff;
      line-height: 1.6;
    }
    a {
      color: #a855f7;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    /* Header styles */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem 2rem;
      background-color: rgba(15, 17, 35, 0.9);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .logo h1 {
      color: #a855f7;
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    .main-nav ul {
      display: flex;
      align-items: center;
      gap: 2rem;
      list-style: none;
    }
    .main-nav a {
      color: #fff;
      text-decoration: none;
      font-size: 0.9rem;
      transition: color 0.3s;
    }
    .main-nav a:hover {
      color: #a855f7;
    }
    .btn-enterprise {
      background-color: #a855f7;
      color: white;
      border: none;
      padding: 0.5rem 1.2rem;
      border-radius: 4px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .btn-enterprise:hover {
      background-color: #9333ea;
    }
    /* Hero section styles */
    .hero-section {
      text-align: center;
      padding: 4rem 1rem;
      max-width: 800px;
      margin: 0 auto;
    }
    .hero-content h2 {
      color: #a855f7;
      font-size: 2.5rem;
      margin-bottom: 1rem;
      line-height: 1.2;
    }
    .hero-content p {
      color: #d1d5db;
      font-size: 1.1rem;
      margin-bottom: 2rem;
    }
    /* Upload section styles */
    .upload-section {
      padding: 2rem;
      display: flex;
      justify-content: center;
    }
    .upload-container {
      background-color: rgba(30, 32, 50, 0.7);
      padding: 2rem;
      border-radius: 12px;
      width: 100%;
      max-width: 600px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(168, 85, 247, 0.2);
    }
    .upload-container h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: #fff;
    }
    .upload-container p {
      color: #d1d5db;
      margin-bottom: 1.5rem;
    }
    .file-upload-area {
      border: 2px dashed #4b5563;
      border-radius: 8px;
      padding: 2rem;
      text-align: center;
      position: relative;
      cursor: pointer;
      margin-bottom: 1rem;
      transition: border-color 0.3s;
    }
    .file-upload-area:hover, .file-upload-area.drag-over {
      border-color: #a855f7;
      background-color: rgba(168, 85, 247, 0.05);
    }
    .hidden-input {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }
    .upload-icon {
      margin-bottom: 1rem;
      color: #a855f7;
    }
    .file-label {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #d1d5db;
    }
    .file-type-hint {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-top: 0.5rem;
    }
    .file-list {
      margin-top: 1rem;
      margin-bottom: 1.5rem;
    }
    .file-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #2d3748;
      border-radius: 4px;
      padding: 0.5rem 1rem;
      margin-bottom: 0.5rem;
    }
    .file-name {
      color: white;
      font-size: 0.9rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      max-width: 80%;
    }
    .delete-file {
      color: #ef4444;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      transition: color 0.2s;
    }
    .delete-file:hover {
      color: #b91c1c;
    }
    .btn-analyze {
      background-color: #a855f7;
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      width: 100%;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
    }
    .btn-analyze:hover {
      background-color: #9333ea;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
    }
    .btn-analyze:disabled {
      background-color: #6b21a8;
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    /* Dashboard section styles - ENHANCED */
    .dashboard-section {
      padding: 2rem;
      max-width: 1200px;
      margin: 0 auto;
      display: none; /* Initially hidden */
    }
    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .dashboard-header h3 {
      font-size: 2.5rem;
      color: #fff;
      font-weight: 600;
      background: linear-gradient(90deg, #a855f7, #7928ca);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .dashboard-actions {
      display: flex;
      gap: 1rem;
    }
    .btn-filter, .btn-export {
      background-color: rgba(30, 32, 50, 0.7);
      color: white;
      border: 1px solid rgba(168, 85, 247, 0.2);
      padding: 0.6rem 1.2rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
    }
    .btn-filter:hover, .btn-export:hover {
      background-color: rgba(168, 85, 247, 0.15);
      border-color: rgba(168, 85, 247, 0.4);
      transform: translateY(-2px);
    }
    /* Enhanced Metrics Grid */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    .metric-card {
      background: linear-gradient(145deg, rgba(30, 32, 50, 0.7), rgba(40, 42, 70, 0.7));
      padding: 1.7rem;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
      border: 1px solid rgba(168, 85, 247, 0.15);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .metric-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, #a855f7, #7928ca);
      opacity: 0.8;
    }
    .metric-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      border-color: rgba(168, 85, 247, 0.4);
    }
    .metric-value {
      font-size: 2.5rem;
      margin-bottom: 0.7rem;
      font-weight: 700;
      background: linear-gradient(90deg, #a855f7, #7928ca);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      display: block;
    }
    .metric-label {
      color: #d1d5db;
      font-size: 0.95rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    /* Enhanced chart navigation */
    .chart-tabs {
      display: flex;
      gap: 0.8rem;
      margin-bottom: 1.8rem;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(168, 85, 247, 0.2);
    }
    .chart-tabs::-webkit-scrollbar {
      display: none;
    }
    .chart-tab {
      background: none;
      border: none;
      color: #a3a3c2;
      padding: 0.7rem 1.2rem;
      cursor: pointer;
      font-size: 0.95rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      white-space: nowrap;
    }
    .chart-tab.active {
      color: #fff;
      background: rgba(168, 85, 247, 0.15);
      font-weight: 500;
    }
    .chart-tab:hover:not(.active) {
      color: #fff;
      background: rgba(168, 85, 247, 0.1);
    }
    /* Enhanced Charts Grid */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    .chart-card {
      background: linear-gradient(145deg, rgba(30, 32, 50, 0.7), rgba(40, 42, 70, 0.7));
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
      border: 1px solid rgba(168, 85, 247, 0.15);
      transition: all 0.3s ease;
      min-height: 400px;
    }
    .chart-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      border-color: rgba(168, 85, 247, 0.4);
    }
    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.2rem 1.5rem;
      border-bottom: 1px solid rgba(168, 85, 247, 0.1);
    }
    .chart-header h4 {
      font-size: 1.1rem;
      color: #fff;
      font-weight: 600;
    }
    .chart-controls {
      display: flex;
      gap: 0.5rem;
    }
    .btn-chart-control, .btn-expand-chart {
      background: none;
      border: none;
      color: #a3a3c2;
      cursor: pointer;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }
    .btn-chart-control:hover, .btn-expand-chart:hover {
      background-color: rgba(168, 85, 247, 0.1);
      color: #fff;
    }
    .chart-body {
      padding: 1.5rem;
      height: 300px;
      position: relative;
      width: 100%;
    }
    /* Chart expanded view */
    .chart-expanded {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(15, 17, 35, 0.95);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 2rem;
    }
    .chart-expanded .chart-body {
      width: 90%;
      height: 70vh;
      max-width: 1200px;
    }
    .chart-expanded .close-expanded {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
    }
    /* AI Analysis Section */
    .ai-analysis-section {
      margin-top: 2rem;
      background: linear-gradient(145deg, rgba(30, 32, 50, 0.7), rgba(40, 42, 70, 0.7));
      border-radius: 16px;
      padding: 1.8rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
      border: 1px solid rgba(168, 85, 247, 0.15);
    }
    .ai-analysis-section h3 {
      font-size: 1.5rem;
      margin-bottom: 0.8rem;
      color: #fff;
      background: linear-gradient(90deg, #a855f7, #7928ca);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      display: inline-block;
    }
    .ai-analysis-section p {
      color: #d1d5db;
      margin-bottom: 1.2rem;
    }
    .btn-analyze-ai {
      background: linear-gradient(90deg, #a855f7, #7928ca);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      max-width: 200px;
      font-weight: 500;
    }
    .btn-analyze-ai:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
    }
    /* AI Chat Box */
    .ai-chat-box {
      border-radius: 12px;
      overflow: hidden;
      background-color: rgba(30, 32, 50, 0.7);
      border: 1px solid rgba(168, 85, 247, 0.2);
      margin-top: 1.2rem;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }
    .chat-messages {
      padding: 1.5rem;
      max-height: 350px;
      min-height: 200px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: rgba(168, 85, 247, 0.3) rgba(30, 32, 50, 0.7);
    }
    .chat-messages::-webkit-scrollbar {
      width: 6px;
    }
    .chat-messages::-webkit-scrollbar-track {
      background: rgba(30, 32, 50, 0.7);
    }
    .chat-messages::-webkit-scrollbar-thumb {
      background-color: rgba(168, 85, 247, 0.3);
      border-radius: 6px;
    }
    .message {
      margin-bottom: 1.2rem;
      padding: 1rem 1.2rem;
      border-radius: 12px;
      max-width: 85%;
      animation: fadeIn 0.3s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .ai-message {
      background-color: rgba(45, 55, 72, 0.8);
      color: #e2e8f0;
      border-left: 3px solid #a855f7;
    }
    .user-message {
      background-color: rgba(75, 85, 99, 0.8);
      color: #e2e8f0;
      margin-left: auto;
      border-right: 3px solid #a855f7;
    }
    .chat-input-container {
      display: flex;
      background-color: rgba(31, 41, 55, 0.8);
      padding: 1rem;
      gap: 0.8rem;
      border-top: 1px solid rgba(168, 85, 247, 0.15);
    }
    #chat-input {
      flex: 1;
      background-color: rgba(55, 65, 81, 0.8);
      border: 1px solid rgba(168, 85, 247, 0.2);
      padding: 0.8rem 1rem;
      border-radius: 8px;
      color: white;
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }
    #chat-input:focus {
      outline: none;
      border-color: rgba(168, 85, 247, 0.5);
      box-shadow: 0 0 0 2px rgba(168, 85, 247, 0.2);
    }
    .btn-send {
      background: linear-gradient(90deg, #a855f7, #7928ca);
      color: white;
      border: none;
      padding: 0.8rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .btn-send:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
    }
    /* Help button */
    .help-button {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      z-index: 100;
    }
    .btn-help {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(145deg, #a855f7, #7928ca);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }
    .btn-help:hover {
      transform: scale(1.1);
      box-shadow: 0 8px 25px rgba(168, 85, 247, 0.4);
    }
    /* Loading spinner */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #a855f7;
      animation: spin 1s ease-in-out infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    /* Toast notifications */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 1rem 1.5rem;
      border-radius: 10px;
      color: white;
      font-weight: 500;
      z-index: 1000;
      opacity: 0;
      transform: translateY(-20px);
      transition: opacity 0.3s, transform 0.3s;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }
    .toast.success {
      background: linear-gradient(145deg, #10b981, #059669);
    }
    .toast.error {
      background: linear-gradient(145deg, #ef4444, #dc2626);
    }
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }
    /* Utility classes */
    .hidden {
      display: none !important;
    }
    /* Responsive styles */
    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        padding: 1rem;
      }
      .main-nav ul {
        margin-top: 1rem;
        gap: 1rem;
        flex-wrap: wrap;
        justify-content: center;
      }
      .hero-content h2 {
        font-size: 2rem;
      }
      .dashboard-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }
      .charts-grid {
        grid-template-columns: 1fr;
      }
      .chart-body {
        height: 250px;
      }
    }
  </style>
</head>
<body>
  <!-- Header Navigation -->
  <header class="header">
    <div class="logo">
      <h1>SmartDataHub</h1>
    </div>
    <nav class="main-nav">
      <ul>
        <li><a href="#">Features</a></li>
        <li><a href="#">Pricing</a></li>
        <li><a href="#">Reports</a></li>
        <li><a href="#">Support</a></li>
      </ul>
    </nav>
    <div class="cta-button">
      <button class="btn-enterprise">Try Enterprise</button>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <h2>Transform Data into Actionable Insights</h2>
      <p>Leverage AI-powered analytics to unlock hidden patterns, optimize performance, and drive business growth</p>
    </div>
  </section>

  <!-- File Upload Section -->
  <section class="upload-section">
    <div class="upload-container">
      <h3>Upload Your Data</h3>
      <p>Upload your data files to analyze and visualize</p>
      <form id="upload-form" enctype="multipart/form-data">
        <div class="file-upload-area">
          <input type="file" id="file-input" name="files[]" multiple class="hidden-input">
          <label for="file-input" class="file-label">
            <div class="upload-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 16.5V6.5M12 6.5L7.5 11M12 6.5L16.5 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 17.5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V17.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <span>Drag & drop files or click to browse</span>
            <span class="file-type-hint">Supports CSV, Excel, JSON and other Python-compatible formats</span>
          </label>
        </div>
        <div id="file-list" class="file-list"></div>
        <button type="submit" id="analyze-button" class="btn-analyze">Analyze with AI</button>
      </form>
    </div>
  </section>

  <!-- Dashboard Section (Initially Hidden) -->
  <section id="dashboard-section" class="dashboard-section">
    <div class="dashboard-header">
      <h3>Analytics Overview</h3>
      <div class="dashboard-actions">
        <button class="btn-filter">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 4h16v2.5L14 12v6l-4 2v-8L4 6.5V4z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Filter
        </button>
        <button class="btn-export">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 3v12M12 15l4-4M12 15l-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M8 21H16M3 21h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Export
        </button>
      </div>
    </div>

    <!-- Enhanced Key Metrics (values now rely solely on provided data) -->
    <div class="metrics-grid" id="metrics-grid">
      <!-- Metrics will be dynamically populated from the uploaded file -->
    </div>

    <!-- Enhanced Chart Selection Tabs -->
    <div class="chart-tabs">
      <button class="chart-tab active" data-chart="overview">Overview</button>
    
    </div>

    <!-- Charts Grid -->
    <div class="charts-grid">
      <div class="chart-card">
        <div class="chart-header">
          <h4>Performance Metrics</h4>
          <div class="chart-controls">
            <button class="btn-expand-chart" data-chart="performanceChart">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 3h6v6M14 10l7-7M9 21H3v-6M10 14l-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="chart-body">
          <canvas id="performanceChart"></canvas>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-header">
          <h4>Category Distribution</h4>
          <div class="chart-controls">
            <button class="btn-expand-chart" data-chart="categoryChart">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 3h6v6M14 10l7-7M9 21H3v-6M10 14l-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="chart-body">
          <canvas id="categoryChart"></canvas>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-header">
          <h4>Monthly Comparison</h4>
          <div class="chart-controls">
            <button class="btn-expand-chart" data-chart="comparisonChart">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 3h6v6M14 10l7-7M9 21H3v-6M10 14l-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="chart-body">
          <canvas id="comparisonChart"></canvas>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-header">
          <h4>Data Dimensions</h4>
          <div class="chart-controls">
            <button class="btn-expand-chart" data-chart="radarChart">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 3h6v6M14 10l7-7M9 21H3v-6M10 14l-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="chart-body">
          <canvas id="radarChart"></canvas>
        </div>
      </div>


    <!-- AI Analysis Section -->
    <div class="ai-analysis-section">
      <h3>AI-Powered Insights</h3>
      <p>Get deeper insights about your data with our AI assistant</p>
      <button id="btn-analyze-ai" class="btn-analyze-ai">Analyze with AI</button>

      <!-- AI Chat Box -->
      <div id="ai-chat-box" class="ai-chat-box">
        <div class="chat-messages" id="chat-messages">
          <!-- Initial AI message -->
          <div class="message ai-message">
            <p>Hello! I'm your AI data assistant. After you upload and analyze your data, I'll provide insights and answer any questions you have.</p>
          </div>
        </div>
        <div class="chat-input-container">
          <input type="text" id="chat-input" placeholder="Ask a question about your data...">
          <button id="send-message" class="btn-send">
            <svg width="90" height="20" viewBox="0 0 24 24" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Help Button -->
  <div class="help-button">
    <button class="btn-help">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
        xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="12" r="10" stroke="white" stroke-width="2"/>
        <path d="M12 17h.01M12 14v-1c1.1045 0 2-.8954 2-2s-.8955-2-2-2-2 .8954-2 2" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </div>

  <!-- Toast Notification -->
  <div class="toast" id="toast"></div>

  <!-- Scripts -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // DOM elements
      const uploadForm = document.getElementById('upload-form');
      const fileInput = document.getElementById('file-input');
      const fileList = document.getElementById('file-list');
      const analyzeButton = document.getElementById('analyze-button');
      const dashboardSection = document.getElementById('dashboard-section');
      const btnAnalyzeAi = document.getElementById('btn-analyze-ai');
      const aiChatBox = document.getElementById('ai-chat-box');
      const chatInput = document.getElementById('chat-input');
      const sendMessage = document.getElementById('send-message');
      const chatMessages = document.getElementById('chat-messages');
      const toast = document.getElementById('toast');
      const chartTabs = document.querySelectorAll('.chart-tab');
      const expandButtons = document.querySelectorAll('.btn-expand-chart');

      // Track uploaded files
      let uploadedFiles = [];

      // Chart objects
      let performanceChart = null;
      let categoryChart = null;
      let comparisonChart = null;
      let radarChart = null;
      let groupedBarChart = null;

      // Handle file selection
      fileInput.addEventListener('change', function() {
        updateFileList(this.files);
      });

      // Function to update file list
      function updateFileList(files) {
        uploadedFiles = Array.from(files);
        fileList.innerHTML = '';
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';
          fileItem.innerHTML = `
            <span class="file-name">${file.name}</span>
            <button type="button" class="delete-file" data-index="${i}">×</button>
          `;
          fileList.appendChild(fileItem);
        }
        document.querySelectorAll('.delete-file').forEach(button => {
          button.addEventListener('click', function() {
            const index = parseInt(this.getAttribute('data-index'));
            removeFile(index);
          });
        });
      }

      // Function to remove a file
      function removeFile(index) {
        uploadedFiles.splice(index, 1);
        const dataTransfer = new DataTransfer();
        uploadedFiles.forEach(file => {
          dataTransfer.items.add(file);
        });
        fileInput.files = dataTransfer.files;
        updateFileList(fileInput.files);
      }

      // Drag and drop support
      const fileUploadArea = document.querySelector('.file-upload-area');
      ['dragenter', 'dragover'].forEach(eventName => {
        fileUploadArea.addEventListener(eventName, function(e) {
          e.preventDefault();
          e.stopPropagation();
          this.classList.add('drag-over');
        });
      });
      ['dragleave', 'drop'].forEach(eventName => {
        fileUploadArea.addEventListener(eventName, function(e) {
          e.preventDefault();
          e.stopPropagation();
          this.classList.remove('drag-over');
        });
      });
      fileUploadArea.addEventListener('drop', function(e) {
        fileInput.files = e.dataTransfer.files;
        updateFileList(fileInput.files);
      });

      // Handle form submission
      uploadForm.addEventListener('submit', function(e) {
        e.preventDefault();
        if (fileInput.files.length === 0) {
          showToast('Please select files to analyze', 'error');
          return;
        }
        const formData = new FormData();
        for (let i = 0; i < fileInput.files.length; i++) {
          formData.append('files[]', fileInput.files[i]);
        }
        analyzeButton.disabled = true;
        analyzeButton.innerHTML = '<span class="loading-spinner"></span> Analyzing...';
        fetch('/upload', {
          method: 'POST',
          body: formData
        })
          .then(response => {
            if (!response.ok) {
              return response.text().then(text => { throw new Error('Network response was not ok: ' + response.status); });
            }
            return response.json();
          })
          .then(data => {
            if (data.success) {
              return fetch('/analyze', { method: 'GET' });
            } else {
              throw new Error(data.error || 'Error uploading files');
            }
          })
          .then(response => {
            if (!response.ok) {
              return response.text().then(text => { throw new Error('Analysis failed: ' + response.status); });
            }
            return response.json();
          })
          .then(data => {
            analyzeButton.disabled = false;
            analyzeButton.textContent = 'Analyze with AI';
            if (data.success) {
              showToast('Analysis complete!', 'success');
              updateDashboard(data);
              const aiMessage = document.createElement('div');
              aiMessage.className = 'message ai-message';
              aiMessage.innerHTML = `<p>${data.ai_insights || 'Analysis complete. Check the Analytics Overview below!'}</p>`;
              chatMessages.appendChild(aiMessage);
              chatMessages.scrollTop = chatMessages.scrollHeight;
              aiChatBox.classList.remove('hidden');
            } else {
              throw new Error(data.error || 'Error analyzing data');
            }
          })
          .catch(error => {
            analyzeButton.disabled = false;
            analyzeButton.textContent = 'Analyze with AI';
            showToast(error.message, 'error');
          });
      });

      // Update dashboard with data (no predefined defaults – data comes solely from the file)
      function updateDashboard(data) {
        dashboardSection.style.display = 'block';
        dashboardSection.scrollIntoView({ behavior: 'smooth' });
        const metricsGrid = document.getElementById('metrics-grid');
        metricsGrid.innerHTML = '';
        const metrics = data.metrics || {};
        Object.entries(metrics).forEach(([key, metric], index) => {
          const card = document.createElement('div');
          card.className = 'metric-card';
          card.style.opacity = '0';
          card.style.transform = 'translateY(20px)';
          card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
          card.innerHTML = `
            <div class="metric-value">${metric.value || ""}</div>
            <div class="metric-label">${metric.label || key}</div>
          `;
          metricsGrid.appendChild(card);
          setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
          }, 100 * index);
        });
        updateCharts(data.charts || {});
      }

      // Update charts – rely solely on data provided in the uploaded file
      function updateCharts(chartData) {
        if (chartData.performance) {
          updatePerformanceChart(chartData.performance);
        }
        if (chartData.category) {
          updateCategoryChart(chartData.category);
        }
        if (chartData.comparison) {
          updateComparisonChart(chartData.comparison);
        }
        if (chartData.radar) {
          updateRadarChart(chartData.radar);
        }
        if (chartData.grouped_bar) {
          updateGroupedBarChart(chartData.grouped_bar);
        }
        setupChartExpansion();
      }

      // Performance Chart (Line)
      function updatePerformanceChart(data) {
        const ctx = document.getElementById('performanceChart').getContext('2d');
        const gradient = ctx.createLinearGradient(0, 0, 0, 300);
        gradient.addColorStop(0, 'rgba(168, 85, 247, 0.4)');
        gradient.addColorStop(1, 'rgba(168, 85, 247, 0.0)');
        let optimizedLabels = data.labels;
        let optimizedValues = data.values;
        if (data.labels && data.labels.length > 20) {
          const step = Math.ceil(data.labels.length / 20);
          optimizedLabels = data.labels.filter((_, i) => i % step === 0);
          optimizedValues = data.values.filter((_, i) => i % step === 0);
        }
        try {
          if (performanceChart instanceof Chart) {
            performanceChart.destroy();
          }
        } catch (e) { console.error("Error destroying performance chart:", e); }
        performanceChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: optimizedLabels,
            datasets: [{
              label: 'Performance',
              data: optimizedValues,
              backgroundColor: gradient,
              borderColor: '#a855f7',
              borderWidth: 2,
              tension: 0.4,
              fill: true,
              pointBackgroundColor: '#a855f7',
              pointBorderColor: '#ffff',
              pointBorderWidth: 2,
              pointRadius: 4,
              pointHoverRadius: 6
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: { duration: 1500, easing: 'easeOutQuart' },
            interaction: { mode: 'nearest', intersect: false, axis: 'x' },
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: 'rgba(30, 32, 50, 0.9)',
                titleColor: '#ffff',
                bodyColor: '#d1d5db',
                padding: 12,
                cornerRadius: 8,
                displayColors: false,
                borderColor: 'rgba(168, 85, 247, 0.3)',
                borderWidth: 1
              }
            },
            scales: {
              y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.05)' }, ticks: { color: '#a3a3c2', padding: 10 } },
              x: { grid: { display: false }, ticks: { color: '#a3a3c2', padding: 10, maxRotation: 45, minRotation: 0, autoSkip: true, maxTicksLimit: 15 } }
            }
          }
        });
      }

      // Category Chart (Pie)
      function updateCategoryChart(data) {
        const ctx = document.getElementById('categoryChart').getContext('2d');
        try {
          if (categoryChart instanceof Chart) {
            categoryChart.destroy();
          }
        } catch (e) { console.error("Error destroying category chart:", e); }
        categoryChart = new Chart(ctx, {
          type: 'pie',
          data: {
            labels: data.labels,
            datasets: [{
              data: data.values,
              backgroundColor: ['#a855f7', '#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#ec4899'],
              borderWidth: 3,
              borderColor: 'rgba(17, 24, 39, 0.8)'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: { duration: 1500, animateRotate: true, animateScale: true },
            plugins: {
              legend: { position: 'right', labels: { color: '#d1d5db', font: { size: 11 }, padding: 15, usePointStyle: true, pointStyle: 'circle' } },
              tooltip: {
                backgroundColor: 'rgba(30, 32, 50, 0.9)',
                titleColor: '#ffff',
                bodyColor: '#d1d5db',
                padding: 12,
                cornerRadius: 8,
                displayColors: true,
                borderColor: 'rgba(168, 85, 247, 0.3)',
                borderWidth: 1
              }
            }
          }
        });
      }

      // Comparison Chart (Bar)
      function updateComparisonChart(data) {
        const ctx = document.getElementById('comparisonChart').getContext('2d');
        try {
          if (comparisonChart instanceof Chart) {
            comparisonChart.destroy();
          }
        } catch (e) { console.error("Error destroying comparison chart:", e); }
        comparisonChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: data.labels,
            datasets: [{
              label: 'Comparison',
              data: data.values,
              backgroundColor: 'rgba(168, 85, 247, 0.7)',
              borderWidth: 0,
              borderRadius: 6,
              hoverBackgroundColor: '#a855f7'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: { duration: 1500, easing: 'easeOutQuart' },
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: 'rgba(30, 32, 50, 0.9)',
                titleColor: '#ffff',
                bodyColor: '#d1d5db',
                padding: 12,
                cornerRadius: 8,
                displayColors: false,
                borderColor: 'rgba(168, 85, 247, 0.3)',
                borderWidth: 1
              }
            },
            scales: {
              y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.05)' }, ticks: { color: '#a3a3c2', padding: 10 } },
              x: { grid: { display: false }, ticks: { color: '#a3a3c2', padding: 10, maxRotation: 45, minRotation: 0, autoSkip: true, maxTicksLimit: 15 } }
            }
          }
        });
      }

      // Radar Chart
      function updateRadarChart(data) {
        const ctx = document.getElementById('radarChart').getContext('2d');
        try {
          if (radarChart instanceof Chart) {
            radarChart.destroy();
          }
        } catch (e) { console.error("Error destroying radar chart:", e); }
        const primaryColor = '#a855f7';
        radarChart = new Chart(ctx, {
          type: 'radar',
          data: {
            labels: data.labels,
            datasets: data.datasets.map(dataset => ({
              label: dataset.label,
              data: dataset.data,
              backgroundColor: 'rgba(168, 85, 247, 0.2)',
              borderColor: primaryColor,
              borderWidth: 2,
              pointBackgroundColor: primaryColor,
              pointBorderColor: '#fff',
              pointHoverBackgroundColor: '#fff',
              pointHoverBorderColor: primaryColor,
              pointRadius: 4,
              pointHoverRadius: 6
            }))
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              r: {
                beginAtZero: true,
                ticks: { color: 'rgba(255, 255, 255, 0.7)', backdropColor: 'transparent', z: 100 },
                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                pointLabels: { color: '#d1d5db', font: { size: 11 } }
              }
            },
            plugins: {
              legend: { display: data.datasets.length > 1, position: 'top', labels: { color: '#d1d5db', font: { size: 11 }, padding: 15 } },
              tooltip: {
                backgroundColor: 'rgba(30, 32, 50, 0.9)',
                titleColor: '#ffff',
                bodyColor: '#d1d5db',
                padding: 12,
                cornerRadius: 8,
                displayColors: true,
                borderColor: 'rgba(168, 85, 247, 0.3)',
                borderWidth: 1
              }
            },
            animation: { duration: 1500, easing: 'easeOutQuart' }
          }
        });
      }

      // Grouped Bar Chart
      function updateGroupedBarChart(data) {
        const ctx = document.getElementById('groupedBarChart').getContext('2d');
        try {
          if (groupedBarChart instanceof Chart) {
            groupedBarChart.destroy();
          }
        } catch (e) { console.error("Error destroying grouped bar chart:", e); }
        const colors = [
          'rgba(168, 85, 247, 0.7)',
          'rgba(59, 130, 246, 0.7)',
          'rgba(16, 185, 129, 0.7)',
          'rgba(245, 158, 11, 0.7)',
          'rgba(239, 68, 68, 0.7)'
        ];
        groupedBarChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: data.labels,
            datasets: data.datasets.map((dataset, index) => ({
              label: dataset.label,
              data: dataset.data,
              backgroundColor: colors[index % colors.length],
              borderWidth: 0,
              borderRadius: 4,
              borderSkipped: false,
              hoverBackgroundColor: colors[index % colors.length].replace('0.7', '1')
            }))
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: { duration: 1500, easing: 'easeOutQuart' },
            plugins: {
              legend: { display: data.datasets.length > 1, position: 'top', labels: { color: '#d1d5db', font: { size: 11 }, padding: 15 } },
              tooltip: {
                backgroundColor: 'rgba(30, 32, 50, 0.9)',
                titleColor: '#ffff',
                bodyColor: '#d1d5db',
                padding: 12,
                cornerRadius: 8,
                displayColors: true,
                borderColor: 'rgba(168, 85, 247, 0.3)',
                borderWidth: 1
              }
            },
            scales: {
              y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.05)' }, ticks: { color: '#a3a3c2', padding: 10 } },
              x: { grid: { display: false }, ticks: { color: '#a3a3c2', padding: 10, maxRotation: 45, minRotation: 0, autoSkip: true, maxTicksLimit: 15 } }
            }
          }
        });
      }

      // Setup chart expansion functionality
      function setupChartExpansion() {
        document.querySelectorAll('.btn-expand-chart').forEach(button => {
          button.addEventListener('click', function() {
            const chartId = this.getAttribute('data-chart');
            const chartTitle = this.closest('.chart-card').querySelector('h4').textContent;
            const expandedView = document.createElement('div');
            expandedView.className = 'chart-expanded';
            expandedView.innerHTML = `
              <button class="close-expanded">×</button>
              <h2 style="color: white; margin-bottom: 1rem;">${chartTitle}</h2>
              <div class="chart-body">
                <canvas id="${chartId}-expanded"></canvas>
              </div>
            `;
            document.body.appendChild(expandedView);
            expandedView.querySelector('.close-expanded').addEventListener('click', function(e) {
              e.stopPropagation();
              document.body.removeChild(expandedView);
            });
            const ctx = document.getElementById(`${chartId}-expanded`).getContext('2d');
            let originalChart;
            switch(chartId) {
              case 'performanceChart':
                originalChart = performanceChart;
                break;
              case 'categoryChart':
                originalChart = categoryChart;
                break;
              case 'comparisonChart':
                originalChart = comparisonChart;
                break;
              case 'radarChart':
                originalChart = radarChart;
                break;
              case 'groupedBarChart':
                originalChart = groupedBarChart;
                break;
            }
            if (originalChart) {
              new Chart(ctx, {
                type: originalChart.config.type,
                data: JSON.parse(JSON.stringify(originalChart.data)),
                options: {
                  ...JSON.parse(JSON.stringify(originalChart.config.options)),
                  maintainAspectRatio: false,
                  responsive: true
                }
              });
            }
          });
        });
      }

      // Chart tab selection
      chartTabs.forEach(tab => {
        tab.addEventListener('click', function() {
          chartTabs.forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          console.log('Selected chart tab:', this.dataset.chart);
        });
      });

      // Toggle AI chat box
      btnAnalyzeAi.addEventListener('click', function() {
        aiChatBox.classList.toggle('hidden');
      });

      // Handle chat
      sendMessage.addEventListener('click', sendUserQuestion);
      chatInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') { sendUserQuestion(); }
      });
      function sendUserQuestion() {
        const text = chatInput.value.trim();
        if (text) {
          const userMessageDiv = document.createElement('div');
          userMessageDiv.className = 'message user-message';
          userMessageDiv.innerHTML = `<p>${text}</p>`;
          chatMessages.appendChild(userMessageDiv);
          chatInput.value = '';
          chatMessages.scrollTop = chatMessages.scrollHeight;
          const loadingDiv = document.createElement('div');
          loadingDiv.className = 'message ai-message';
          loadingDiv.innerHTML = '<p><span class="loading-spinner"></span> Thinking...</p>';
          chatMessages.appendChild(loadingDiv);
          fetch('/ask', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ question: text })
          })
            .then(response => {
              if (!response.ok) { throw new Error('Network response was not ok'); }
              return response.json();
            })
            .then(data => {
              chatMessages.removeChild(loadingDiv);
              const aiMessage = document.createElement('div');
              aiMessage.className = 'message ai-message';
              aiMessage.innerHTML = `<p>${data.answer || 'I apologize, but I could not process your request.'}</p>`;
              chatMessages.appendChild(aiMessage);
              chatMessages.scrollTop = chatMessages.scrollHeight;
            })
            .catch(error => {
              chatMessages.removeChild(loadingDiv);
              const aiMessage = document.createElement('div');
              aiMessage.className = 'message ai-message';
              aiMessage.innerHTML = `<p>I'm sorry, I encountered an error processing your question. Please try again.</p>`;
              chatMessages.appendChild(aiMessage);
              chatMessages.scrollTop = chatMessages.scrollHeight;
            });
        }
      }

      function showToast(message, type) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.className = `toast ${type}`;
        toast.classList.add('show');
        setTimeout(() => { toast.classList.remove('show'); }, 3000);
      }
    });
  </script>
</body>
</html>